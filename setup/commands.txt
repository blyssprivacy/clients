
# to update the site
sudo cp -a ~/spiral-rs/sites/balances/. /var/www/html/balances/

# build the server
cargo build --release --bin server --features server

# build the client
wasm-pack build --target web --out-dir ../sites/balances/pkg


# to update the service
sudo cp spiral-balance.service /etc/systemd/system/spiral-balance.service


docker build -t updater -f setup/balances/updater.Dockerfile .
docker run -it --rm -a stdout -v spiral-databases:/spiral-databases --name updater updater

docker build -t worker -f setup/balances/worker.Dockerfile .
docker run -it --rm -p 8089:8089 -p 9089:9089 -a stdout -v spiral-databases:/spiral-databases:ro --name worker worker

docker build -t proxy -f setup/balances/proxy.Dockerfile .
docker run -it --rm -v caddy_data:/data -v spiral-databases:/spiral-databases:ro -p 80:80 -p 443:443 -p 443:443/udp proxy

# inspect db scratch volume
docker run -it --rm -a stdout -v spiral-databases:/mnt/spiral-databases:ro alpine
